<ion-progress-bar *ngIf="loading" type="indeterminate"></ion-progress-bar>
<div *ngIf="recipe">
    <app-recipe-details-image [recipe]="recipe" (wasSuccessfullyChanged)="imageChanges($event)"></app-recipe-details-image>
    <div class="headerContainer">
        <div class="editBox">
            <ion-fab-button (click)="updateRecipe()" *ngIf="editMode">
                <ion-icon color="success" name="save-outline"></ion-icon>
            </ion-fab-button>
            <ion-fab-button size="great" color="danger" (click)="deleteRecipe()" *ngIf="editMode">
                <ion-icon color="dark" name="trash-outline"></ion-icon>
            </ion-fab-button>
            <ion-fab-button  (click)="editMode = !editMode">
                <ion-icon  name="pencil-outline" *ngIf="!editMode"></ion-icon>
                <ion-icon color="danger" name="close-outline" *ngIf="editMode"></ion-icon>
            </ion-fab-button>
        </div>
        <app-name-edit title="Rezept" [item]="recipe" [editMode]="editMode" (changes)="newName = $event"></app-name-edit>
    </div>

    <h4>zugewiesenen Abteilungen</h4>
    <app-general-details-edit-relations [service]="branchService" [editMode]="editMode" [defaultQuery]="query" [items]="branches" (itemsToAdd)="addBranches = $event" (itemsToRemove)="rmvBranches = $event"></app-general-details-edit-relations>
    
    <h4>zugewiesenen Kategorien</h4>
    <app-general-details-edit-relations [service]="categoryService" [editMode]="editMode" [defaultQuery]="query" [items]="categories" (itemsToAdd)="addCategories = $event" (itemsToRemove)="rmvCategories = $event"></app-general-details-edit-relations>


    <h4>Varianten</h4>
    <ion-button (click)="addVariant()">Varianten hinzufügen</ion-button>

    <app-variant-card [variant]="variant" *ngFor="let variant of recipe.variants"></app-variant-card>

</div>


//TODO cleanup
<div *ngIf="!recipe">
    <ion-card>
        <ion-card-header>
            <ion-card-title>Hier eine Art Warenkorb inder alle Zutaten über die Varianten summiert werden (optional)</ion-card-title>
        </ion-card-header>
        <ion-card-content>
            <ion-list>
                <ion-item>
                    Zutat: Zucker 2kg
                </ion-item>
                <ion-item>
                    Zutat: Mehl 20kg
                </ion-item>
                <ion-item>
                    Zutat: Stärke 2kg
                </ion-item>
                <ion-item>
                    Zutat: Zucer 2kg
                </ion-item>
            </ion-list>
        </ion-card-content>
    </ion-card>

    <div>
        <h2>Varianten</h2>
        <ion-card>
            <ion-card-header>
                <ion-card-title>Schokotart</ion-card-title>
                <ion-card-subtitle>RUND</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
                In Warenkorb <ion-checkbox checked="true"></ion-checkbox> <br>
                gewünschte Größe <br>
                gewünschte Menge <br>
            </ion-card-content>
        </ion-card>
        <ion-card>
            <ion-card-header>
                <ion-card-title>Schokokuppel</ion-card-title>
                <ion-card-subtitle>Massenumrechnung</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
                In Warenkorb <ion-checkbox checked="true"></ion-checkbox> <br>
                gewünschte Größe <br>
                gewünschte Menge <br>
            </ion-card-content>
        </ion-card>
        <ion-card>
            <ion-card-header>
                <ion-card-title>Schokodöner</ion-card-title>
                <ion-card-subtitle>Eckig</ion-card-subtitle>
            </ion-card-header>
            <ion-card-content>
                In Warenkorb <ion-checkbox checked="false"></ion-checkbox> <br>
                gewünschte Größe <br>
                gewünschte Menge <br>
            </ion-card-content>
        </ion-card>
    </div>
</div>
  